{"version":3,"sources":["webpack:///./src/views/rules/teacher/chat/Chat.vue?12d1","webpack:///./src/views/rules/teacher/chat/Chat.vue?dd1e","webpack:///src/views/rules/teacher/chat/Chat.vue","webpack:///./src/views/rules/teacher/chat/Chat.vue?a97d","webpack:///./src/views/rules/teacher/chat/Chat.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","class","classes","attrs","staticStyle","on","$event","$router","back","_v","_s","student","name","_l","message","key","id","from","profile","content","sending","nativeOn","type","indexOf","_k","keyCode","sendMessage","model","value","callback","$$v","$set","expression","staticRenderFns","data","$route","params","to","email","messages","methods","fetchStudent","offset","err","fetchMessages","scrollToBottom","$nextTick","container","scrollTo","top","scrollHeight","behavior","computed","mounted","window","Echo","private","component"],"mappings":"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","file":"js/chunk-9a0801b8.1c265999.js","sourcesContent":["import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=style&index=0&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"main-content\"},[_c('div',{staticClass:\"panel\"},[_c('div',{staticClass:\"panel-header\",class:_vm.classes},[_c('div',{staticClass:\"panel-tools\"},[_c('el-row',{attrs:{\"gutter\":20}},[_c('el-col',{staticStyle:{\"text-align\":\"left\"},attrs:{\"span\":12}},[_c('el-button',{attrs:{\"type\":\"info\",\"plain\":\"\"},on:{\"click\":function($event){return _vm.$router.back()}}},[_vm._v(\"Go back\")])],1)],1)],1)]),_c('div',{staticClass:\"panel-body\",class:_vm.classes,staticStyle:{\"height\":\"80vh\",\"display\":\"flex\",\"flex-direction\":\"row\"}},[_c('el-main',{staticStyle:{\"padding\":\"0\"}},[_c('el-container',{staticClass:\"is-vertical\",staticStyle:{\"height\":\"100%\"}},[_c('div',{staticClass:\"chat-header\"},[_c('h1',[_vm._v(_vm._s(_vm.student.name))])]),_c('el-main',{staticStyle:{\"flex\":\"1\",\"flex-basis\":\"auto\",\"overflow\":\"hidden\",\"box-sizing\":\"border-box\",\"display\":\"block\",\"margin\":\"0 20px\",\"padding\":\"0\"}},[_c('div',{staticClass:\"messages-container\"},_vm._l((_vm.messages),function(message){return _c('div',{key:message.id},[_c('div',{class:message.from === _vm.profile.id ? 'im-message-text right' : 'im-message-text left'},[_c('pre',[_vm._v(_vm._s(message.content))])])])}),0)]),_c('el-footer',{staticStyle:{\"margin-top\":\"20px\"}},[_c('el-row',[_c('el-col',[_c('el-input',{attrs:{\"placeholder\":\"Press Enter to send\",\"disabled\":_vm.sending},nativeOn:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.sendMessage($event)}},model:{value:(_vm.message.content),callback:function ($$v) {_vm.$set(_vm.message, \"content\", $$v)},expression:\"message.content\"}})],1)],1)],1)],1)],1)],1)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"main-content\">\n    <div class=\"panel\">\n      <div class=\"panel-header\" :class=\"classes\">\n        <div class=\"panel-tools\">\n          <el-row :gutter=\"20\">\n            <el-col :span=\"12\" style=\"text-align: left\">\n              <el-button type=\"info\" plain @click=\"$router.back()\">Go back</el-button>\n            </el-col>\n          </el-row>\n        </div>\n      </div>\n      <div class=\"panel-body\" :class=\"classes\" style=\"height: 80vh; display: flex; flex-direction: row\">\n        <el-main style=\"padding: 0\">\n          <el-container class=\"is-vertical\" style=\"height: 100%\">\n            <div class=\"chat-header\">\n              <h1>{{student.name}}</h1>\n            </div>\n            <el-main style=\"flex: 1; flex-basis: auto; overflow: hidden; box-sizing: border-box; display: block; margin: 0 20px; padding: 0\">\n              <div class=\"messages-container\">\n                <div v-for=\"message in messages\" :key=\"message.id\">\n                  <div :class=\"message.from === profile.id ? 'im-message-text right' : 'im-message-text left'\">\n                    <pre>{{ message.content }}</pre>\n                  </div>\n                </div>\n              </div>\n            </el-main>\n            <el-footer style=\"margin-top: 20px\">\n              <el-row>\n                <el-col>\n                  <el-input placeholder=\"Press Enter to send\" :disabled=\"sending\" v-model=\"message.content\" @keyup.enter.native=\"sendMessage\"></el-input>\n                </el-col>\n              </el-row>\n            </el-footer>\n          </el-container>\n        </el-main>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport {mapState} from 'vuex'\nimport api from '../../../../apis'\n\nexport default {\n  name: 'Chat',\n  data() {\n    return {\n      id: this.$route.params.id,\n      classes: ['animated', 'fade-in', 'fast'],\n      sending: false,\n      message: {\n        to: this.$route.params.id,\n        content: ''\n      },\n      student: {\n        id: '',\n        name: '',\n        email: '',\n      },\n      messages: []\n    }\n  },\n  methods: {\n    fetchStudent() {\n      api.student.fetchStudent(this.id).then(res => {\n        this.student = res.data;\n      }).catch(err => {\n        this.$message.error({\n          offset: 95,\n          message: err.message\n        });\n      });\n    },\n    fetchMessages() {\n      api.message.fetchMessages({to: this.id}).then(res => {\n        this.messages = res.data;\n        this.scrollToBottom();\n      }).catch(err => {\n        this.$message.error({\n          offset: 95,\n          message: err.message\n        });\n      });\n    },\n    sendMessage() {\n      this.sending = true;\n      api.message.sendMessage(this.message).then(res => {\n        this.sending = false;\n        this.message.content = '';\n        this.messages.push(res.data);\n        this.scrollToBottom();\n      }).catch(err => {\n        this.sending = false;\n        this.$message.error({\n          offset: 95,\n          message: err.message\n        });\n      })\n    },\n    scrollToBottom() {\n      this.$nextTick(() => {\n        let container = this.$el.querySelector('.messages-container');\n        container.scrollTo({\n          top: container.scrollHeight,\n          behavior: 'smooth'\n        })\n      });\n    }\n  },\n  computed: {\n    ...mapState({\n      profile: state => state.account.profile,\n      access_token: state => state.account.access_token\n    })\n  },\n  mounted() {\n    window.Echo.private(`message.${this.profile.id}`)\n        .listen('.MessageNotification', (e) => {\n          this.messages.push(e.message)\n          this.scrollToBottom();\n        });\n\n    this.fetchStudent();\n    this.fetchMessages();\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.chat-header {\n  padding: 20px;\n  border-bottom-style: inset;\n}\n\n.messages-container {\n  height: 100%;\n  overflow-y: auto;\n  overflow-x: hidden;\n\n  .im-message-text {\n    clear: both;\n    max-width: 70%;\n    min-width: 30px;\n    min-height: 30px;\n    padding: 3px;\n    margin: 10px 0;\n    background: #daf3fd;\n\n    pre {\n      font-size: 14px;\n      overflow: hidden;\n      word-break: break-word;\n      white-space: pre-wrap;\n      padding: 3px 10px;\n    }\n  }\n\n  .right {\n    float: right;\n    border-radius: 10px 0 10px 10px;\n  }\n\n  .left {\n    float: left;\n    background: #e7e7e7;\n    border-radius: 0 10px 10px 10px;\n  }\n}\n</style>","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Chat.vue?vue&type=template&id=b4c70cea&\"\nimport script from \"./Chat.vue?vue&type=script&lang=js&\"\nexport * from \"./Chat.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Chat.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}