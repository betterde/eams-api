(function(e){function t(t){for(var r,a,i=t[0],u=t[1],s=t[2],l=0,f=[];l<i.length;l++)a=i[l],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&f.push(o[a][0]),o[a]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);d&&d(t);while(f.length)f.shift()();return c.push.apply(c,s||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],r=!0,a=1;a<n.length;a++){var i=n[a];0!==o[i]&&(r=!1)}r&&(c.splice(t--,1),e=u(u.s=n[0]))}return e}var r={},a={index:0},o={index:0},c=[];function i(e){return u.p+"js/"+({}[e]||e)+"."+{"chunk-1134eb26":"fc3f04d2","chunk-28e8ae78":"5f0d1534","chunk-2d0a3754":"c1f62063","chunk-2d0a41f1":"4bb15882","chunk-2d230f9d":"662404fa","chunk-4c9f2f5c":"1a2891c6","chunk-65c915fa":"de2ca264","chunk-6b6afef5":"7a61fa0e","chunk-8406c9b4":"a2bbad9c","chunk-85fa51fc":"2cdc873c","chunk-9a0801b8":"1c265999","chunk-a47b01d6":"3ea34dde","chunk-e5ae0a26":"bb9558f2"}[e]+".js"}function u(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.e=function(e){var t=[],n={"chunk-1134eb26":1,"chunk-28e8ae78":1,"chunk-4c9f2f5c":1,"chunk-65c915fa":1,"chunk-6b6afef5":1,"chunk-8406c9b4":1,"chunk-85fa51fc":1,"chunk-9a0801b8":1,"chunk-a47b01d6":1,"chunk-e5ae0a26":1};a[e]?t.push(a[e]):0!==a[e]&&n[e]&&t.push(a[e]=new Promise((function(t,n){for(var r="css/"+({}[e]||e)+"."+{"chunk-1134eb26":"532cb670","chunk-28e8ae78":"17396a21","chunk-2d0a3754":"31d6cfe0","chunk-2d0a41f1":"31d6cfe0","chunk-2d230f9d":"31d6cfe0","chunk-4c9f2f5c":"c11bd1ec","chunk-65c915fa":"cce195f2","chunk-6b6afef5":"1577ca23","chunk-8406c9b4":"c0c4a77d","chunk-85fa51fc":"d5d3b4b3","chunk-9a0801b8":"31e4234a","chunk-a47b01d6":"31e4234a","chunk-e5ae0a26":"e5dc5bff"}[e]+".css",o=u.p+r,c=document.getElementsByTagName("link"),i=0;i<c.length;i++){var s=c[i],l=s.getAttribute("data-href")||s.getAttribute("href");if("stylesheet"===s.rel&&(l===r||l===o))return t()}var f=document.getElementsByTagName("style");for(i=0;i<f.length;i++){s=f[i],l=s.getAttribute("data-href");if(l===r||l===o)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var r=t&&t.target&&t.target.src||o,c=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");c.code="CSS_CHUNK_LOAD_FAILED",c.request=r,delete a[e],d.parentNode.removeChild(d),n(c)},d.href=o;var h=document.getElementsByTagName("head")[0];h.appendChild(d)})).then((function(){a[e]=0})));var r=o[e];if(0!==r)if(r)t.push(r[2]);else{var c=new Promise((function(t,n){r=o[e]=[t,n]}));t.push(r[2]=c);var s,l=document.createElement("script");l.charset="utf-8",l.timeout=120,u.nc&&l.setAttribute("nonce",u.nc),l.src=i(e);var f=new Error;s=function(t){l.onerror=l.onload=null,clearTimeout(d);var n=o[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;f.message="Loading chunk "+e+" failed.\n("+r+": "+a+")",f.name="ChunkLoadError",f.type=r,f.request=a,n[1](f)}o[e]=void 0}};var d=setTimeout((function(){s({type:"timeout",target:l})}),12e4);l.onerror=l.onload=s,document.head.appendChild(l)}return Promise.all(t)},u.m=e,u.c=r,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)u.d(n,r,function(t){return e[t]}.bind(null,r));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="/",u.oe=function(e){throw console.error(e),e};var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var f=0;f<s.length;f++)t(s[f]);var d=l;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("b866")},"3f6e":function(e,t,n){},4360:function(e,t,n){"use strict";var r=n("2b0e"),a=n("2f62"),o={state:{layout:{current:"guest"},action:"list"},mutations:{SET_LAYOUT_CURRENT:function(e,t){r["default"].set(e.layout,"current",t)}}},c=n("61c5");r["default"].use(a["a"]);t["a"]=new a["a"].Store({modules:{system:o,account:c["a"]},strict:"production"!==Object({NODE_ENV:"production",VUE_APP_BASE_URL:"https://eng-interview-0911-b6b8b939816a.herokuapp.com",VUE_APP_PUSHER_APP_KEY:"5a5911500d480f9a115f",VUE_APP_PUSHER_APP_CLUSTER:"mt1",BASE_URL:"/"}).MIX_NODE_ENV})},"61c5":function(e,t,n){"use strict";(function(e){n("7f7f");var r=n("2b0e"),a=n("f8c8"),o=n("6e87"),c={id:"",name:"",email:"",guard:""},i=localStorage.getItem("profile");i&&(c=e.JSON.parse(i)),t["a"]={state:{profile:c,expires_in:0,access_token:localStorage.getItem("access_token"),refresh_token:localStorage.getItem("refresh_token")},mutations:{SET_PROFILE:function(t,n){if(!1===n)r["default"].set(t,"profile",{id:"",name:"",email:"",guard:""}),localStorage.removeItem("profile");else{var a={id:n.id,name:n.name,email:n.email,guard:n.guard};n.hasOwnProperty("school_id")&&(a.school_id=n.school_id),r["default"].set(t,"profile",a),localStorage.setItem("profile",e.JSON.stringify(a))}},SET_ACCESS_TOKEN:function(e,t){!1===t?(r["default"].set(e,"expires_in",0),r["default"].set(e,"access_token",null),r["default"].set(e,"refresh_token",null),localStorage.removeItem("expires_in"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")):(r["default"].set(e,"expires_in",t.expires_in),r["default"].set(e,"access_token",t.access_token),r["default"].set(e,"refresh_token",t.refresh_token),localStorage.setItem("expires_in",t.expires_in),localStorage.setItem("access_token",t.access_token),localStorage.setItem("refresh_token",t.refresh_token))}},actions:{signUp:function(e,t){var n=e.commit;return new Promise((function(e,r){a["a"].account.register(t.query,t.params).then((function(t){n(o["a"],t.data),e(t)})).catch((function(e){r(e)}))}))},signIn:function(e,t){var n=e.commit;return new Promise((function(e,r){a["a"].account.signin(t).then((function(t){n(o["a"],t.data),e(t)})).catch((function(e){r(e)}))}))},verification:function(e,t){var n=e.commit;return new Promise((function(e,r){a["a"].account.verification(t).then((function(t){n(o["a"],t.data),e(t)})).catch((function(e){r(e)}))}))},fetchProfile:function(e){var t=e.commit;return new Promise((function(e,n){a["a"].account.profile().then((function(n){t(o["b"],n.data),e(n)})).catch((function(e){t(o["b"],!1),n(e)}))}))}}}}).call(this,n("c8ba"))},"6e87":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r="SET_PROFILE",a="SET_ACCESS_TOKEN"},"83c9":function(e,t,n){},a18c:function(e,t,n){"use strict";n("7f7f");var r=n("2b0e"),a=n("4360"),o=n("8c4f"),c=n("c1c4");r["default"].use(o["a"]);var i=o["a"].prototype.push;o["a"].prototype.push=function(e){return i.call(this,e).catch((function(e){return e}))};var u=[{path:"/signup",name:"signup",meta:{rules:[],requiresAuth:!1},component:function(){return n.e("chunk-28e8ae78").then(n.bind(null,"ae12"))}},{path:"/signin",name:"signin",meta:{rules:[],requiresAuth:!1},component:function(){return n.e("chunk-1134eb26").then(n.bind(null,"8dfd"))}},{path:"/forgot",name:"forgot",meta:{rules:[],requiresAuth:!1},component:function(){return n.e("chunk-e5ae0a26").then(n.bind(null,"5632"))}},{path:"/reset",name:"reset",meta:{rules:[],requiresAuth:!1},component:function(){return n.e("chunk-6b6afef5").then(n.bind(null,"53c7"))}},{path:"*",name:"notfound",meta:{rules:[],requiresAuth:!1},component:function(){return n.e("chunk-65c915fa").then(n.bind(null,"aee3"))}}],s=new o["a"]({mode:"history",base:"/",routes:u});a["a"].state.account.access_token&&a["a"].state.account.profile.guard&&s.addRoutes(Object(c["a"])(a["a"].state.account.profile.guard)),s.beforeEach((function(e,t,n){"notfound"===e.name&&a["a"].commit("SET_LAYOUT_CURRENT","guest"),"/"===e.fullPath&&"notfound"===e.name&&n({path:"/signin"}),"notfound"===t.name&&!0===e.meta.requiresAuth&&a["a"].commit("SET_LAYOUT_CURRENT","backend"),a["a"].state.account.access_token&&"/signin"===e.path&&n({path:"/"}),e.matched.some((function(e){return e.meta.requiresAuth}))&&null===a["a"].state.account.access_token?n({path:"/signin"}):n()})),t["a"]=s},b866:function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var r=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n(e.layout.current,{tag:"component"})],1)},o=[],c=(n("8e6e"),n("ac6a"),n("456d"),n("bd86")),i=n("2f62"),u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("router-view")},s=[],l={name:"guest"},f=l,d=(n("c476"),n("2877")),h=Object(d["a"])(f,u,s,!1,null,null,null),p=h.exports,m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",[n("el-header",[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:2}},[n("div",{staticClass:"grid-content logo"},[n("h3",{staticStyle:{"line-height":"36px"}},[n("router-link",{attrs:{to:"/"}},[e._v("EAMS")])],1)])]),n("el-col",{attrs:{span:20}},["teacher"===e.profile.guard?n("el-menu",{staticClass:"el-menu-nav",attrs:{"default-active":e.module,mode:"horizontal",router:""}},[n("el-menu-item",{attrs:{index:"/"}},[e._v("Dashboard")]),n("el-menu-item",{attrs:{index:"/school"}},[e._v("School")]),n("el-menu-item",{attrs:{index:"/followers"}},[e._v("Followers")])],1):n("el-menu",{staticClass:"el-menu-nav",attrs:{"default-active":e.module,mode:"horizontal",router:""}},[n("el-menu-item",{attrs:{index:"/"}},[e._v("Dashboard")]),n("el-menu-item",{attrs:{index:"/chat"}},[e._v("Chat")]),n("el-menu-item",{attrs:{index:"/teacher"}},[e._v("Teacher")])],1)],1),n("el-col",{attrs:{span:2}},[n("el-row",{attrs:{gutter:20,type:"flex",justify:"end"}},[n("el-col",{staticStyle:{"text-align":"right"},attrs:{lg:12,xl:8}},[n("el-badge",{staticStyle:{margin:"12px 0"},attrs:{value:e.notifications.length,type:"info",hidden:0===e.notifications.length}},[n("el-popover",{attrs:{placement:"bottom",width:"80",trigger:"click"}},[n("el-table",{attrs:{data:e.notifications,"empty-text":"No data"}},[n("el-table-column",{attrs:{property:"name",label:"Sender"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.goToChat(t.row)}}},[e._v(e._s(t.row.name))])]}}])})],1),n("el-button",{staticStyle:{height:"36px",width:"36px"},attrs:{slot:"reference",size:"medium",icon:"el-icon-bell",circle:""},slot:"reference"})],1)],1)],1),n("el-col",{staticStyle:{"text-align":"right"},attrs:{lg:12,xl:8}},[n("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleCommand}},[n("span",{staticClass:"el-dropdown-link"},[n("div",{staticClass:"avatar grid-content",domProps:{innerHTML:e._s(e.profile.name.slice(0,1))}})]),n("el-dropdown-menu",{scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-dropdown-item",{attrs:{command:"profile"}},[e._v("Personal")]),n("el-dropdown-item",{attrs:{command:"signOut"}},[e._v("Sign out")])]}}])})],1)],1)],1)],1)],1)],1),n("el-main",[n("el-row",{attrs:{justify:"center"}},[n("el-col",{attrs:{xs:24,sm:24,md:24,lg:{span:20,offset:2},xl:{span:20,offset:2}}},[n("router-view")],1)],1)],1)],1)},g=[],b=(n("7f7f"),n("4917"),n("5df3"),n("f400"),n("5638"));function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(n,!0).forEach((function(t){Object(c["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k={name:"backend",data:function(){return{senders:new Map,notifications:[]}},methods:{goToChat:function(e){var t=this.senders.get(e.id);this.notifications.splice(t,1),"student"===this.profile.guard?this.$router.push({path:"/chat"}):this.$router.push({path:"/chat/".concat(e.id)})},handleCommand:function(e){switch(e){case"signOut":this.signOut();break;case"profile":this.$router.push({path:"/profile"});break}},signOut:function(){this.$store.commit("SET_ACCESS_TOKEN",!1),this.$store.commit("SET_PROFILE",!1),this.$message.success("Sign out successful"),window.location.href="/signin"}},computed:_({},Object(i["b"])({profile:function(e){return e.account.profile},access_token:function(e){return e.account.access_token}}),{module:function(){var e=this.$route.path.match(/\/[a-z]*/);return e.shift()}}),mounted:function(){var e=this;window.Pusher=n("782e"),window.Pusher.logToConsole=!0,window.Echo=new b["a"]({broadcaster:"pusher",key:"5a5911500d480f9a115f",auth:{headers:{Authorization:"Bearer ".concat(this.access_token)}},cluster:"mt1",encrypted:!0,logToConsole:!0}),window.Echo.private("notify.".concat(this.profile.id)).listen(".MessageNotification",(function(t){if(!1===e.senders.has(t.sender.id)){if("teacher"===e.profile.guard&&"chat"===e.$route.name&&e.$route.params.id===t.sender.id)return;if("student"===e.profile.guard&&"chat"===e.$route.name)return;e.notifications.push({id:t.sender.id,name:t.sender.name,type:"message"}),e.senders.set(t.sender.id,e.notifications.length-1)}}))}},y=k,w=(n("f120"),Object(d["a"])(y,m,g,!1,null,null,null)),O=w.exports;function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(n,!0).forEach((function(t){Object(c["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E={name:"app",data:function(){return{}},methods:{},components:{guest:p,backend:O},computed:x({},Object(i["b"])({layout:function(e){return e.system.layout},profile:function(e){return e.account.profile}})),watch:{profile:function(e){""!==e.id&&this.$store.commit("SET_LAYOUT_CURRENT","backend")},$route:function(e){!1===e.meta.hasOwnProperty("requiresAuth")||!1===e.meta.requiresAuth?this.$store.commit("SET_LAYOUT_CURRENT","guest"):this.$store.commit("SET_LAYOUT_CURRENT","backend")}}},P=E,T=Object(d["a"])(P,a,o,!1,null,null,null),A=T.exports,j=n("4360"),C=n("a18c"),N=n("cee4"),R={baseURL:"https://eng-interview-0911-b6b8b939816a.herokuapp.com",timeout:6e4,withCredentials:!1},U=N["a"].create(R);U.interceptors.request.use((function(e){for(var t in e.params)!e.params.hasOwnProperty(t)||""!==e.params[t]&&null!==e.params[t]||delete e.params[t];return j["a"].state.account.access_token&&(e.headers.Authorization="Bearer ".concat(j["a"].state.account.access_token)),e}),(function(e){return Promise.reject(e)})),U.interceptors.response.use((function(e){return e.data instanceof Blob?e:e.data}),(function(e){return 401===e.response.status&&(j["a"].commit("SET_PROFILE",!1),j["a"].commit("SET_ACCESS_TOKEN",!1),C["a"].push("/signin")),Promise.reject(e.response.data)})),Plugin.install=function(e){e.axios=U,window.axios=U,Object.defineProperties(e.prototype,{axios:{get:function(){return U}},$axios:{get:function(){return U}}})},r["default"].use(Plugin);Plugin;var q=n("5c96"),I=n.n(q);n("c69f");r["default"].use(I.a),r["default"].config.productionTip=!1,new r["default"]({store:j["a"],router:C["a"],render:function(e){return e(A)}}).$mount("#app")},c1c4:function(e,t,n){"use strict";function r(e){return"student"===e?[{path:"/",name:"dashboard",meta:{rules:["student"],requiresAuth:!0},component:function(){return n.e("chunk-2d230f9d").then(n.bind(null,"ef28"))}},{path:"/teacher",name:"teacher",meta:{rules:["student"],requiresAuth:!0},component:function(){return n.e("chunk-2d0a3754").then(n.bind(null,"01eb"))}},{path:"/chat",name:"chat",meta:{requiresAuth:!0,rules:["student"]},component:function(){return n.e("chunk-a47b01d6").then(n.bind(null,"44ba"))}}]:[{path:"/",name:"dashboard",meta:{rules:["teacher"],requiresAuth:!0},component:function(){return n.e("chunk-2d230f9d").then(n.bind(null,"ef28"))}},{path:"/school",name:"school",meta:{requiresAuth:!0,rules:["teacher"]},component:function(){return n.e("chunk-8406c9b4").then(n.bind(null,"33e6"))},children:[{path:":id/detail",name:"schoolDetail",meta:{requiresAuth:!0,rules:["teacher"]},component:function(){return n.e("chunk-4c9f2f5c").then(n.bind(null,"124b"))}}]},{path:"/followers",name:"followers",meta:{requiresAuth:!0,rules:["teacher"]},component:function(){return n.e("chunk-2d0a41f1").then(n.bind(null,"04a8"))}},{path:"/chat/:id",name:"chat",meta:{requiresAuth:!0,rules:["teacher"]},component:function(){return n.e("chunk-9a0801b8").then(n.bind(null,"1932"))}},{path:"/profile",name:"profile",meta:{requiresAuth:!0,rules:["teacher"]},component:function(){return n.e("chunk-85fa51fc").then(n.bind(null,"dd14"))}}]}t["a"]=function(e){return r(e)}},c476:function(e,t,n){"use strict";var r=n("3f6e"),a=n.n(r);a.a},c69f:function(e,t,n){},f120:function(e,t,n){"use strict";var r=n("83c9"),a=n.n(r);a.a},f8c8:function(e,t,n){"use strict";var r=n("2b0e"),a={fetchSchools:function(e){return r["default"].axios.get("/api/school",{params:e})},createSchool:function(e){return r["default"].axios.post("/api/school",e)},fetchSchool:function(e){return r["default"].axios.get("/api/school/".concat(e))},deleteSchool:function(e){return r["default"].axios.delete("/api/school/".concat(e))}},o={fetchTeachers:function(e){return r["default"].axios.get("/api/teacher",{params:e})},changeFollowStatus:function(e){return r["default"].axios.put("/api/teacher/follow",e)},fetchFollowers:function(e){return r["default"].axios.get("/api/teacher/followers",e)}},c={fetchStudents:function(e){return r["default"].axios.get("/api/student",{params:e})},createStudent:function(e){return r["default"].axios.post("/api/student",e)},fetchStudent:function(e){return r["default"].axios.get("/api/student/".concat(e))}},i={register:function(e,t){return e.email&&e.signature?r["default"].axios.post("/api/auth/register?email=".concat(e.email,"&school=").concat(e.school,"&expires=").concat(e.expires,"&signature=").concat(e.signature),t):r["default"].axios.post("/api/auth/register",t)},forgot:function(e){return r["default"].axios.post("/api/auth/password/email",e)},resetPassword:function(e){return r["default"].axios.post("/api/auth/password/reset",e)},signin:function(e){return r["default"].axios.post("/api/auth/password",e)},verification:function(e){return r["default"].axios.post("/api/auth/issue",e)},profile:function(){return r["default"].axios.get("/api/account/profile")},password:function(e){return r["default"].axios.post("/api/profile/password",e)},address:function(e){return r["default"].axios.post("/api/profile/address",e)}},u={fetchMessages:function(e){return r["default"].axios.get("/api/message/history",{params:e})},sendMessage:function(e){return r["default"].axios.post("/api/message/send",e)}},s={fetchDashboard:function(){return r["default"].axios.get("/api/dashboard")}},l={fetchInvitations:function(e){return r["default"].axios.get("/api/invitation",{params:e})},createInvitation:function(e){return r["default"].axios.post("/api/invitation",e)}};t["a"]={school:a,teacher:o,student:c,message:u,account:i,dashboard:s,invitation:l}}});
//# sourceMappingURL=index.88959ffd.js.map