(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4c9f2f5c"],{"124b":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"panel"},[a("div",{staticClass:"panel-header",class:e.classes},[a("div",{staticClass:"panel-tools"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{staticStyle:{"text-align":"left"},attrs:{span:12}},[a("el-button",{attrs:{type:"info",plain:""},on:{click:function(t){return e.$router.back()}}},[e._v("Go back")])],1),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[e.profile.id===e.school.manager_id&&"student"===e.active?a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleCreateStudent}},[e._v("Create")]):e.profile.id===e.school.manager_id&&"invitation"===e.active?a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleTeacherInvitation}},[e._v("Create")]):e._e()],1)],1)],1)]),a("el-dialog",{attrs:{title:"Invitation",visible:e.invitation.dialog,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.invitation,"dialog",t)},close:function(t){return e.handleClose("create")}}},[a("el-form",{ref:"invitation",attrs:{model:e.invitation.params,rules:e.invitation.rules,"label-position":"top"}},[a("el-form-item",{attrs:{label:"Email",prop:"email"}},[a("el-input",{attrs:{type:"string",clearable:""},model:{value:e.invitation.params.email,callback:function(t){e.$set(e.invitation.params,"email",t)},expression:"invitation.params.email"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.invitation.dialog=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submit("invitation")}}},[e._v("确定")])],1)],1),a("el-dialog",{attrs:{title:"Student",visible:e.student.create.dialog,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.student.create,"dialog",t)},close:function(t){return e.handleClose("create")}}},[a("el-form",{ref:"student",attrs:{model:e.student.create.params,rules:e.student.create.rules,"label-position":"top"}},[a("el-form-item",{attrs:{label:"Name",prop:"name"}},[a("el-input",{attrs:{type:"string",clearable:""},model:{value:e.student.create.params.name,callback:function(t){e.$set(e.student.create.params,"name",t)},expression:"student.create.params.name"}})],1),a("el-form-item",{attrs:{label:"Email",prop:"email"}},[a("el-input",{attrs:{type:"string",clearable:""},model:{value:e.student.create.params.email,callback:function(t){e.$set(e.student.create.params,"email",t)},expression:"student.create.params.email"}})],1),a("el-form-item",{attrs:{label:"Password",prop:"password"}},[a("el-input",{attrs:{type:"password","show-password":""},model:{value:e.student.create.params.password,callback:function(t){e.$set(e.student.create.params,"password",t)},expression:"student.create.params.password"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.student.create.dialog=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submit("student")}}},[e._v("确定")])],1)],1),a("div",{staticClass:"panel-body",class:e.classes},[a("div",{staticClass:"details",staticStyle:{padding:"20px"}},[a("table",[a("tbody",[a("tr",[a("td",{staticClass:"detail-item"},[a("span",{staticClass:"detail-item-label detail-item-colon"},[e._v("ID")]),a("span",{staticClass:"detail-item-content"},[e._v(e._s(e.school.id))])]),a("td",{staticClass:"detail-item"},[a("span",{staticClass:"detail-item-label detail-item-colon"},[e._v("Name")]),a("span",{staticClass:"detail-item-content"},[e._v(e._s(e.school.name))])]),a("td",{staticClass:"detail-item"},[a("span",{staticClass:"detail-item-label detail-item-colon"},[e._v("Status")]),a("span",{staticClass:"detail-item-content"},[e._v(e._s(e.enums.school.status[e.school.status]))])]),a("td",{staticClass:"detail-item"},[a("span",{staticClass:"detail-item-label detail-item-colon"},[e._v("Manager")]),a("span",{staticClass:"detail-item-content"},[e._v(e._s(e.school.manager.name))])]),a("td",{staticClass:"detail-item"},[a("span",{staticClass:"detail-item-label detail-item-colon"},[e._v("Created At")]),a("span",{staticClass:"detail-item-content"},[e._v(e._s(e.school.created_at))])])])])])]),a("el-tabs",{on:{"tab-click":e.changeTab},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[a("el-tab-pane",{attrs:{label:"Student",name:"student"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.student.loading,expression:"student.loading"}],ref:"pipeline",staticStyle:{width:"100%"},attrs:{data:e.students}},[a("el-table-column",{attrs:{prop:"id",label:"ID"}}),a("el-table-column",{attrs:{prop:"name",label:"Name"}}),a("el-table-column",{attrs:{prop:"email",label:"Email"}}),a("el-table-column",{attrs:{prop:"created_at",label:"Created At"}}),e.profile.id===e.school.manager_id?a("el-table-column",{attrs:{prop:"option",label:"Actions",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Chat",placement:"top"}},[a("el-button",{attrs:{size:"mini",icon:"el-icon-chat-dot-round",plain:"",circle:"",disabled:e.school.manager_id!==e.profile.id},on:{click:function(a){return e.goToChat(t.row)}}})],1),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Delete",placement:"top"}},[a("el-button",{attrs:{size:"mini",icon:"el-icon-delete",type:"danger",plain:"",circle:"",disabled:e.profile.id===e.school.manager_id},on:{click:function(a){return e.handleDeleteStudent(t.row)}}})],1)]}}],null,!1,1196020343)}):e._e()],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"sizes, total, prev, pager, next","page-size":e.student.query.size,"page-sizes":e.student.meta.page_sizes,"current-page":e.student.query.page,total:e.student.meta.total},on:{"update:currentPage":function(t){return e.$set(e.student.query,"page",t)},"update:current-page":function(t){return e.$set(e.student.query,"page",t)},"current-change":e.handleStudentsTableCurrentChange,"size-change":e.handleStudentsTableSizeChange}})],1)],1),e.profile.id===e.school.manager_id?a("el-tab-pane",{attrs:{label:"Teacher",name:"teacher"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.teacher.loading,expression:"teacher.loading"}],ref:"pipeline",staticStyle:{width:"100%"},attrs:{data:e.teachers}},[a("el-table-column",{attrs:{prop:"id",label:"ID"}}),a("el-table-column",{attrs:{prop:"name",label:"Name"}}),a("el-table-column",{attrs:{prop:"email",label:"Email"}}),a("el-table-column",{attrs:{prop:"pivot.role",label:"Role"}}),a("el-table-column",{attrs:{prop:"created_at",label:"Join At"}}),a("el-table-column",{attrs:{prop:"option",label:"Actions",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Delete",placement:"top"}},[a("el-button",{attrs:{size:"mini",icon:"el-icon-delete",type:"danger",plain:"",circle:""},on:{click:function(a){return e.handleDeleteTeacher(t.row)}}})],1)]}}],null,!1,72176271)})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"sizes, total, prev, pager, next","page-size":e.teacher.query.size,"page-sizes":e.teacher.meta.page_sizes,"current-page":e.teacher.query.page,total:e.teacher.meta.total},on:{"update:currentPage":function(t){return e.$set(e.teacher.query,"page",t)},"update:current-page":function(t){return e.$set(e.teacher.query,"page",t)},"current-change":e.handleTeachersTableCurrentChange,"size-change":e.handleTeachersTableSizeChange}})],1)],1):e._e(),e.profile.id===e.school.manager_id?a("el-tab-pane",{attrs:{label:"Invitation",name:"invitation"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.invitation.loading,expression:"invitation.loading"}],ref:"pipeline",staticStyle:{width:"100%"},attrs:{data:e.invitations}},[a("el-table-column",{attrs:{prop:"id",label:"ID"}}),a("el-table-column",{attrs:{prop:"email",label:"Email"}}),a("el-table-column",{attrs:{prop:"initiator.name",label:"Initiator"}}),a("el-table-column",{attrs:{prop:"status",label:"Activated"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.status?a("el-tag",[e._v("Yes")]):a("el-tag",{attrs:{type:"info"}},[e._v("No")])]}}],null,!1,3980982576)}),a("el-table-column",{attrs:{prop:"expires",label:"Expires"}}),a("el-table-column",{attrs:{prop:"created_at",label:"Join At"}}),a("el-table-column",{attrs:{prop:"option",label:"Actions",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Delete",placement:"top"}},[a("el-button",{attrs:{size:"mini",icon:"el-icon-delete",type:"danger",plain:"",circle:""},on:{click:function(a){return e.handleDeleteTeacher(t.row)}}})],1)]}}],null,!1,72176271)})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"sizes, total, prev, pager, next","page-size":e.invitation.query.size,"page-sizes":e.teacher.meta.page_sizes,"current-page":e.invitation.query.page,total:e.teacher.meta.total},on:{"update:currentPage":function(t){return e.$set(e.invitation.query,"page",t)},"update:current-page":function(t){return e.$set(e.invitation.query,"page",t)},"current-change":e.handleTeachersTableCurrentChange,"size-change":e.handleTeachersTableSizeChange}})],1)],1):e._e()],1)],1)],1)},i=[],s=(a("8e6e"),a("ac6a"),a("456d"),a("bd86")),r=(a("7f7f"),a("2f62")),l=a("f8c8");function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(a,!0).forEach((function(t){Object(s["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var u={name:"Detail",data:function(){return{step:0,enums:{school:{status:["Unknown","Pending","Approved","Rejected"]}},active:"student",school:{id:"",name:"",status:"",manager:{id:"",name:""},manager_id:"",created_at:""},classes:["animated","fade-in","fast"],student:{loading:!1,query:{school_id:this.$route.params.id,only_followers:!1,size:5,page:1},meta:{total:0,page_sizes:[10,20,50]},create:{dialog:!1,params:{name:"",email:"",password:"",password_confirmation:"",school_id:this.$route.params.id},rules:{name:[{type:"string",required:!0,message:"Please enter student name",trigger:"blur"}],email:[{type:"email",required:!0,message:"Please enter email",trigger:"blur"}],password:[{type:"string",required:!0,message:"Please enter password",trigger:"blur"}]}}},teacher:{loading:!1,query:{school_id:this.$route.params.id,size:5,page:1},meta:{total:0,page_sizes:[10,20,50]}},invitation:{loading:!1,dialog:!1,query:{size:5,page:1,school_id:this.$route.params.id},params:{email:"",school_id:this.$route.params.id},meta:{total:0,page_sizes:[10,20,50]},rules:{email:[{type:"email",required:!0,message:"Please enter email",trigger:"blur"}]}},teachers:[],students:[],invitations:[]}},methods:{fetchSchool:function(){var e=this;this.$route.params.hasOwnProperty("id")?l["a"].school.fetchSchool(this.$route.params.id).then((function(t){e.school=t.data})).catch((function(t){e.$message.error({offset:95,message:t.message})})):this.$message.error({offset:95,message:"Missing school ID parameter"})},fetchTeachers:function(){var e=this;this.$route.params.hasOwnProperty("id")&&(this.teacher.loading=!0,l["a"].teacher.fetchTeachers(this.teacher.query).then((function(t){e.teachers=t.data,e.teacher.loading=!1,e.teacher.meta.total=t.total})).catch((function(t){e.$message.error({offset:95,message:t.message}),e.teacher.loading=!1})))},fetchStudents:function(){var e=this;this.$route.params.hasOwnProperty("id")&&(this.student.loading=!0,l["a"].student.fetchStudents(this.student.query).then((function(t){e.students=t.data,e.student.loading=!1,e.student.meta.total=t.total})).catch((function(t){e.$message.error({offset:95,message:t.message}),e.student.loading=!1})))},fetchInvitations:function(){var e=this;this.$route.params.hasOwnProperty("id")&&(this.invitation.loading=!0,l["a"].invitation.fetchInvitations(this.invitation.params).then((function(t){e.invitations=t.data,e.invitation.loading=!1,e.invitation.meta.total=t.total})).catch((function(t){e.$message.error({offset:95,message:t.message}),e.student.loading=!1})))},handleTeacherInvitation:function(){this.invitation.dialog=!0},handleCreateStudent:function(){this.student.create.dialog=!0},handleClose:function(e){switch(e){case"create":this.$refs.create.resetFields();break;case"update":break}},submit:function(e){var t=this;switch(e){case"invitation":this.$refs.invitation.validate((function(e){if(!e)return!1;l["a"].invitation.createInvitation(t.invitation.params).then((function(e){t.$message.success({offset:95,message:e.message}),t.fetchInvitations(),t.invitation.dialog=!1})).catch((function(e){t.$message.error({offset:95,message:e.message})}))}));break;case"student":this.$refs.student.validate((function(e){if(!e)return!1;t.student.create.params.password_confirmation=t.student.create.params.password,l["a"].student.createStudent(t.student.create.params).then((function(e){t.$message.success({offset:95,message:e.message}),t.fetchStudents(),t.student.create.dialog=!1})).catch((function(e){t.$message.error({offset:95,message:e.message})}))}));break}},goToChat:function(e){this.$router.push({path:"/chat/".concat(e.id)})},changeTab:function(e){"teacher"===e.name&&this.fetchTeachers(),"student"===e.name&&this.fetchStudents(),"invitation"===e.name&&this.fetchInvitations()},handleDeleteTeacher:function(e){var t=this;this.$confirm("此操作将删除订单中的商品，是否继续","警告",{confirmButtonText:"继续",cancelButtonText:"取消",type:"warning"}).then((function(){})).catch((function(){t.$message.info({offset:95,message:"Operation canceled"})}))},handleDeleteStudent:function(e){var t=this;this.$confirm("此操作将删除订单中的商品，是否继续","警告",{confirmButtonText:"继续",cancelButtonText:"取消",type:"warning"}).then((function(){})).catch((function(){t.$message.info({offset:95,message:"Operation canceled"})}))},handleTeachersTableCurrentChange:function(e){this.teacher.query.page=e,this.fetchTeachers()},handleTeachersTableSizeChange:function(e){this.teacher.query.size=e,this.fetchTeachers()},handleStudentsTableCurrentChange:function(e){this.student.query.page=e,this.fetchTeachers()},handleStudentsTableSizeChange:function(e){this.student.query.size=e,this.fetchTeachers()}},computed:c({},Object(r["b"])({profile:function(e){return e.account.profile}})),mounted:function(){this.invitation.params.school_id=this.$route.params.id,this.fetchSchool(),this.fetchStudents()}},d=u,p=(a("b66e"),a("2877")),m=Object(p["a"])(d,n,i,!1,null,null,null);t["default"]=m.exports},"5c90":function(e,t,a){},b66e:function(e,t,a){"use strict";var n=a("5c90"),i=a.n(n);i.a}}]);
//# sourceMappingURL=chunk-4c9f2f5c.d742454d.js.map